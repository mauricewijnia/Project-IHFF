@using Project_IHFF.Models;
@using System.Collections.Generic;

@model IEnumerable<ExhibitionViewModel>

@foreach (ExhibitionViewModel film in Model)
            {
    <div class="contentBox">
        <div class="col-md-2 noPadd">
            <img src="@film.Image" style="height:13em" />
        </div>
        <div class="col-md-10 noPadd whiteText">
            <div class="col-md-9">
                <h1 class="title">@film.Name</h1>
                <h3 class="subTitle">@film.Director</h3>
                <p class="description">@film.Description</p>
                <p>@film.Actors</p>           
            </div>
            <div class="col-md-3">
                <p>@film.StartTime.DayOfWeek</p>
                <p>@film.StartTime.ToString("HH:mm") - @film.EndTime.Value.ToString("HH:mm")</p>
                <p>@film.Location</p>
            </div>
            <div class="clearfix"></div>
            <div class="col-md-12 verticalCenter noSelect">
                <span id="@("add"+film.ExhibitionId)" class="glyphicon glyphicon-plus-sign qtyBtn"></span>
                <span id="@("qty"+film.ExhibitionId)">1</span>
                <span id="@("min"+film.ExhibitionId)" class="glyphicon glyphicon-minus-sign qtyBtn"></span>
                <a class="btn btn-default shopBtn" id="@("addToProgramme"+film.ExhibitionId)">To Programme</a>
                <a class="btn btn-default shopBtn" id="@("addToCart"+film.ExhibitionId)">To shopping Cart</a>
            </div>
        </div>
        <div class="clearfix"></div>
    </div>
}

<script type="text/javascript">
    $(document).ready(function()
    {

        $(".qtyBtn").click(function (e)
        {

            var id = $(this).attr('id');
            var idNr = id.slice(3);

            var qty = parseInt($("#qty" + idNr).html());

            if (id.substring(0, 3) == "add") {
                $("#qty" + idNr).html(qty + 1);
            } else if (id.substring(0, 3) == "min" && qty != "1") {
                $("#qty" + idNr).html(qty - 1);
            }

        });


        $('.shopBtn').on('click', function (e) {

        var fullId = $(this).attr('id');
        var cart = (fullId.substring(5, 9) == "Cart") ? true : false;
        var exhibitionId = (cart == true) ? fullId.slice(9) : fullId.slice(14);
            //var qty = $("#qty"+ exhibitionId).html;
        var qty = document.getElementById('qty' + exhibitionId).innerHTML;
        var fout = false;
        //alert(storage + " " + exhibitionId);
        //var getItemId = parseInt($(this).closest('td').prop('id'));
        //var getUserName = $('.divName').html();

        e.preventDefault();
        $.ajax({

            //url: $(this).attr("href"),
            url: '/ShoppingCart/Add',
            data: {id:exhibitionId, Quantity:qty, shopcart:cart, remove:false},
            //data: "{ 'id':' " + exhibitionId + "','quantity':' " + qty + "','shopcart':' " + true + " ','remove':' " + fout + " ' }",
            //data: "{ 'id':' " + 3 + "','quantity':' " + 3 + "','shopcart':' " + true + " ','remove':' " + false + " ' }",
            success: function(data){
                alert("Value Added");
            }

        });
        /*$.ajax({
            type: 'POST',
            contentType: 'application/json; charset=utf-8',
            url: '/ShoppingCart/Add',
            data: "{ 'id':' " + exhibitionId + "','quantity':' " + qty + "','shopcart':' " + fout + " ','remove':' " + fout + " ' }",
            success: function (data) {
                alert(data);
            },
            error: function (data) {
                alert(data);
            }
        });*/



    });
});



</script>

